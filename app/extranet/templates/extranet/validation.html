{% extends 'extranet/base.html' %}
{% block title %}Validation des demandes - ICTGROUP{% endblock %}

{% block content %}
<div class="bg-white p-4 md:p-8 rounded-2xl shadow-2xl animate-fade-in">
    <h1 class="text-2xl md:text-3xl font-extrabold text-primary mb-4 text-center tracking-tight">
        Validation des demandes
    </h1>
    <p class="text-gray-600 text-center text-sm md:text-base mb-6">
        Gérez les demandes de congés et de télétravail de votre équipe
    </p>
    
    <!-- Navigation par type - Mobile First -->
    <nav class="mb-6 md:mb-8" role="tablist" aria-label="Types de demandes">
        <ul class="flex flex-col sm:flex-row gap-2 sm:gap-4 justify-center">
            <li role="presentation" class="flex-1 sm:flex-none">
                <a href="?type=leave" 
                   class="block w-full px-4 py-3 sm:px-6 rounded-lg shadow-md bg-gradient-to-r transition-all duration-200 font-semibold focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-center
                          {% if type == 'leave' %}from-primary to-secondary text-white ring-2 ring-primary/30{% else %}from-gray-100 to-gray-200 text-gray-700 hover:from-primary/10 hover:to-secondary/10{% endif %}"
                   role="tab"
                   aria-selected="{% if type == 'leave' %}true{% else %}false{% endif %}"
                   aria-label="Voir les demandes de congés">
                    <span class="flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                        <span class="truncate">Congés</span>
                        {% if user.is_authenticated and user.profile.role in 'manager rh admin' and leave_validation_count %}
                            <span class="inline-flex items-center justify-center bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full animate-pulse ml-2 flex-shrink-0">
                                {{ leave_validation_count }}
                            </span>
                        {% endif %}
                    </span>
                </a>
            </li>
            <li role="presentation" class="flex-1 sm:flex-none">
                <a href="?type=telework" 
                   class="block w-full px-4 py-3 sm:px-6 rounded-lg shadow-md bg-gradient-to-r transition-all duration-200 font-semibold focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 text-center
                          {% if type == 'telework' %}from-orange-500 to-sky-400 text-white ring-2 ring-orange-500/30{% else %}from-gray-100 to-gray-200 text-gray-700 hover:from-orange-500/10 hover:to-sky-400/10{% endif %}"
                   role="tab"
                   aria-selected="{% if type == 'telework' %}true{% else %}false{% endif %}"
                   aria-label="Voir les demandes de télétravail">
                    <span class="flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                        </svg>
                        <span class="truncate">Télétravail</span>
                        {% if user.is_authenticated and user.profile.role in 'manager rh admin' and telework_validation_count %}
                            <span class="inline-flex items-center justify-center bg-orange-500 text-white text-xs font-bold px-2 py-0.5 rounded-full animate-pulse ml-2 flex-shrink-0">
                                {{ telework_validation_count }}
                            </span>
                        {% endif %}
                    </span>
                </a>
            </li>
        </ul>
    </nav>
    
    {% if type == 'leave' %}
        <section aria-labelledby="leave-section">
            <h2 id="leave-section" class="text-xl md:text-2xl font-bold mb-4 md:mb-6 text-primary">
                Demandes de congés à valider
            </h2>
            
            <!-- Version mobile - Cards -->
            <div class="lg:hidden space-y-4">
                {% for leave in leaves %}
                <div class="bg-white border border-gray-200 rounded-xl p-4 shadow-lg hover:shadow-xl transition-all duration-300">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center gap-2">
                            <div class="w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0">
                                <span class="text-primary font-bold text-xs">#{{ leave.id }}</span>
                            </div>
                            <div class="min-w-0 flex-1">
                                <h3 class="font-semibold text-gray-900 text-sm truncate">
                                    {{ leave.user.get_full_name|default:leave.user.username }}
                                </h3>
                                <p class="text-xs text-gray-500">{{ leave.submitted_at|date:'d/m/Y' }}</p>
                            </div>
                        </div>
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium flex-shrink-0
                            {% if leave.status == 'pending' %}bg-yellow-100 text-yellow-800 border border-yellow-200
                            {% elif leave.status == 'approved' %}bg-green-100 text-green-800 border border-green-200
                            {% elif leave.status == 'rejected' %}bg-red-100 text-red-800 border border-red-200{% endif %}">
                            {% if leave.status == 'pending' %}⏳ En attente
                            {% elif leave.status == 'approved' %}✅ Approuvée
                            {% elif leave.status == 'rejected' %}❌ Rejetée{% endif %}
                        </span>
                    </div>
                    
                    <div class="space-y-2 mb-4">
                        <div>
                            <p class="text-xs text-gray-500 uppercase tracking-wide">Période</p>
                            <p class="font-medium text-sm">{{ leave.start_date|date:'d/m/Y' }} → {{ leave.end_date|date:'d/m/Y' }}</p>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <p class="text-xs text-gray-500 uppercase tracking-wide">Manager</p>
                                <div class="flex items-center gap-1">
                                    {% if leave.manager_validated %}
                                        <svg class="w-3 h-3 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                        </svg>
                                        <span class="text-xs text-green-600 font-medium">Validé</span>
                                    {% else %}
                                        <svg class="w-3 h-3 text-yellow-600" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                                        </svg>
                                        <span class="text-xs text-yellow-600 font-medium">En attente</span>
                                    {% endif %}
                                </div>
                            </div>
                            
                            <div>
                                <p class="text-xs text-gray-500 uppercase tracking-wide">RH</p>
                                <div class="flex items-center gap-1">
                                    {% if leave.rh_validated %}
                                        <svg class="w-3 h-3 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                        </svg>
                                        <span class="text-xs text-green-600 font-medium">Validé</span>
                                    {% else %}
                                        <svg class="w-3 h-3 text-yellow-600" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                                        </svg>
                                        <span class="text-xs text-yellow-600 font-medium">En attente</span>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Actions mobile - Boutons complets -->
                    <div class="flex flex-col gap-2 pt-3 border-t border-gray-200">
                        {% if can_validate_as_manager and leave.user.profile.manager == user %}
                            <form method="post" class="w-full">
                                {% csrf_token %}
                                <input type="hidden" name="leave_id" value="{{ leave.id }}">
                                <button name="action" value="manager_approve" 
                                        {% if leave.manager_validated %}disabled{% endif %}
                                        class="w-full flex items-center justify-center gap-2 py-2 px-3 rounded-lg transition-all duration-200 font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 text-sm
                                        {% if leave.manager_validated %}
                                            bg-gray-400 text-white cursor-not-allowed
                                        {% else %}
                                            bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white focus:ring-blue-500
                                        {% endif %}">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        {% if leave.manager_validated %}
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                        {% else %}
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                        {% endif %}
                                    </svg>
                                    {% if leave.manager_validated %}✅ VALIDÉ (Manager){% else %}👤 VALIDER (Manager){% endif %}
                                </button>
                            </form>
                        {% endif %}
                        
                        {% if can_validate_as_rh and leave.user.profile.rh == user %}
                            <form method="post" class="w-full">
                                {% csrf_token %}
                                <input type="hidden" name="leave_id" value="{{ leave.id }}">
                                <button name="action" value="rh_approve" 
                                        {% if not leave.manager_validated or leave.rh_validated %}disabled{% endif %}
                                        class="w-full flex items-center justify-center gap-2 py-2 px-3 rounded-lg transition-all duration-200 font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 text-sm
                                        {% if leave.rh_validated %}
                                            bg-gray-400 text-white cursor-not-allowed
                                        {% elif not leave.manager_validated %}
                                            bg-gray-300 text-gray-500 cursor-not-allowed
                                        {% else %}
                                            bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white focus:ring-green-500
                                        {% endif %}">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        {% if leave.rh_validated %}
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                        {% else %}
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                                        {% endif %}
                                    </svg>
                                    {% if leave.rh_validated %}✅ VALIDÉ (RH){% elif not leave.manager_validated %}⏳ EN ATTENTE (RH){% else %}🏢 VALIDER (RH){% endif %}
                                </button>
                            </form>
                        {% endif %}
                        
                        {% if leave.status == 'pending' and not leave.manager_validated and not leave.rh_validated %}
                            <form method="post" class="w-full">
                                {% csrf_token %}
                                <input type="hidden" name="leave_id" value="{{ leave.id }}">
                                <button name="action" value="reject" 
                                        class="w-full flex items-center justify-center gap-2 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white py-2 px-3 rounded-lg transition-all duration-200 font-semibold focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 text-sm"
                                        onclick="return confirm('Êtes-vous sûr de vouloir rejeter cette demande ?')">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                    ❌ REJETER
                                </button>
                            </form>
                        {% endif %}
                    </div>
                </div>
                {% empty %}
                <div class="text-center py-8">
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                    </div>
                    <p class="text-gray-500 text-sm">Aucune demande de congé à valider</p>
                </div>
                {% endfor %}
            </div>
            
            <!-- Version desktop - Table -->
            <div class="hidden lg:block">
                <div class="overflow-x-auto rounded-lg shadow-md">
                    <table class="min-w-full bg-white" role="table" aria-label="Demandes de congés">
                        <thead class="bg-gradient-to-r from-primary/10 to-secondary/10">
                            <tr>
                                <th scope="col" class="py-4 px-6 text-left font-bold text-primary">Utilisateur</th>
                                <th scope="col" class="py-4 px-6 text-left font-bold text-primary">Période</th>
                                <th scope="col" class="py-4 px-6 text-left font-bold text-primary">Statut</th>
                                <th scope="col" class="py-4 px-6 text-left font-bold text-primary">Manager</th>
                                <th scope="col" class="py-4 px-6 text-left font-bold text-primary">RH</th>
                                <th scope="col" class="py-4 px-6 text-left font-bold text-primary">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            {% for leave in leaves %}
                            <tr class="hover:bg-primary/5 transition-colors duration-200">
                                <td class="py-4 px-6 font-medium text-gray-900">
                                    {{ leave.user.get_full_name|default:leave.user.username }}
                                </td>
                                <td class="py-4 px-6 text-gray-700">
                                    <time datetime="{{ leave.start_date|date:'Y-m-d' }}">{{ leave.start_date|date:'d/m/Y' }}</time>
                                    au 
                                    <time datetime="{{ leave.end_date|date:'Y-m-d' }}">{{ leave.end_date|date:'d/m/Y' }}</time>
                                </td>
                                <td class="py-4 px-6">
                                    <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium
                                        {% if leave.status == 'pending' %}bg-yellow-100 text-yellow-800 border border-yellow-200{% elif leave.status == 'approved' %}bg-green-100 text-green-800 border border-green-200{% elif leave.status == 'rejected' %}bg-red-100 text-red-800 border border-red-200{% endif %}">
                                        {{ leave.get_status_display }}
                                    </span>
                                </td>
                                <td class="py-4 px-6">
                                    {% if leave.manager_validated %}
                                        <span class="inline-flex items-center text-success font-semibold">
                                            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                            </svg>
                                            Validé
                                        </span>
                                    {% else %}
                                        <span class="inline-flex items-center text-yellow-600">
                                            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                                            </svg>
                                            En attente
                                        </span>
                                    {% endif %}
                                </td>
                                <td class="py-4 px-6">
                                    {% if leave.rh_validated %}
                                        <span class="inline-flex items-center text-success font-semibold">
                                            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                            </svg>
                                            Validé
                                        </span>
                                    {% else %}
                                        <span class="inline-flex items-center text-yellow-600">
                                            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                                            </svg>
                                            En attente
                                        </span>
                                    {% endif %}
                                </td>
                                <td class="py-4 px-6">
                                    <div class="flex flex-wrap gap-2 items-center justify-center min-w-max">
                                        {% if can_validate_as_manager and leave.user.profile.manager == user %}
                                            <form method="post" class="inline-block">
                                                {% csrf_token %}
                                                <input type="hidden" name="leave_id" value="{{ leave.id }}">
                                                <button name="action" value="manager_approve" 
                                                        {% if leave.manager_validated %}disabled{% endif %}
                                                        class="flex items-center justify-center gap-1 px-3 py-1 rounded-lg transition-all duration-200 font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 transform hover:scale-105 whitespace-nowrap shadow-lg border-2 text-xs
                                                        {% if leave.manager_validated %}
                                                            bg-gray-400 border-gray-400 text-white cursor-not-allowed
                                                        {% else %}
                                                            bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white border-blue-600 focus:ring-blue-500
                                                        {% endif %}">
                                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        {% if leave.manager_validated %}
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                                        {% else %}
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                                        {% endif %}
                                                    </svg>
                                                    {% if leave.manager_validated %}✅ VALIDÉ{% else %}👤 VALIDER{% endif %}
                                                </button>
                                            </form>
                                        {% endif %}
                                        
                                        {% if can_validate_as_rh and leave.user.profile.rh == user %}
                                            <form method="post" class="inline-block">
                                                {% csrf_token %}
                                                <input type="hidden" name="leave_id" value="{{ leave.id }}">
                                                <button name="action" value="rh_approve" 
                                                        {% if not leave.manager_validated or leave.rh_validated %}disabled{% endif %}
                                                        class="flex items-center justify-center gap-1 px-3 py-1 rounded-lg transition-all duration-200 font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 transform hover:scale-105 whitespace-nowrap shadow-lg border-2 text-xs
                                                        {% if leave.rh_validated %}
                                                            bg-gray-400 border-gray-400 text-white cursor-not-allowed
                                                        {% elif not leave.manager_validated %}
                                                            bg-gray-300 border-gray-300 text-gray-500 cursor-not-allowed
                                                        {% else %}
                                                            bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white border-green-600 focus:ring-green-500
                                                        {% endif %}">
                                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        {% if leave.rh_validated %}
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                                        {% else %}
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                                                        {% endif %}
                                                    </svg>
                                                    {% if leave.rh_validated %}✅ RH{% elif not leave.manager_validated %}⏳ RH{% else %}🏢 RH{% endif %}
                                                </button>
                                            </form>
                                        {% endif %}
                                        
                                        {% if leave.status == 'pending' and not leave.manager_validated and not leave.rh_validated %}
                                            <form method="post" class="inline-block">
                                                {% csrf_token %}
                                                <input type="hidden" name="leave_id" value="{{ leave.id }}">
                                                <button name="action" value="reject" 
                                                        class="flex items-center justify-center gap-1 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white px-3 py-1 rounded-lg transition-all duration-200 font-semibold focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transform hover:scale-105 whitespace-nowrap shadow-lg border-2 border-red-600 text-xs"
                                                        onclick="return confirm('Êtes-vous sûr de vouloir rejeter cette demande ?')">
                                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                                    </svg>
                                                    ❌ REJETER
                                                </button>
                                            </form>
                                        {% endif %}
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="6" class="py-8 text-center text-gray-500">
                                    Aucune demande de congé à valider
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
        
    {% else %}
        <!-- Section télétravail - À adapter de la même manière -->
        <section aria-labelledby="telework-section">
            <h2 id="telework-section" class="text-xl md:text-2xl font-bold mb-4 md:mb-6 text-orange-600">
                Demandes de télétravail à valider
            </h2>
            
            <!-- Version mobile - Cards pour télétravail -->
            <div class="lg:hidden space-y-4">
                {% for telework in teleworks %}
                <div class="bg-white border border-gray-200 rounded-xl p-4 shadow-lg hover:shadow-xl transition-all duration-300">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center gap-2">
                            <div class="w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0">
                                <span class="text-orange-600 font-bold text-xs">#{{ telework.id }}</span>
                            </div>
                            <div class="min-w-0 flex-1">
                                <h3 class="font-semibold text-gray-900 text-sm truncate">
                                    {{ telework.user.get_full_name|default:telework.user.username }}
                                </h3>
                                <p class="text-xs text-gray-500">{{ telework.submitted_at|date:'d/m/Y' }}</p>
                            </div>
                        </div>
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium flex-shrink-0
                            {% if telework.status == 'pending' %}bg-yellow-100 text-yellow-800 border border-yellow-200
                            {% elif telework.status == 'approved' %}bg-green-100 text-green-800 border border-green-200
                            {% elif telework.status == 'rejected' %}bg-red-100 text-red-800 border border-red-200{% endif %}">
                            {% if telework.status == 'pending' %}⏳ En attente
                            {% elif telework.status == 'approved' %}✅ Approuvée
                            {% elif telework.status == 'rejected' %}❌ Rejetée{% endif %}
                        </span>
                    </div>
                    
                    <div class="space-y-2 mb-4">
                        <div>
                            <p class="text-xs text-gray-500 uppercase tracking-wide">Période</p>
                            <p class="font-medium text-sm">{{ telework.start_date|date:'d/m/Y' }} → {{ telework.end_date|date:'d/m/Y' }}</p>
                        </div>
                    </div>
                    
                    <!-- Actions mobile pour télétravail -->
                    <div class="flex flex-col gap-2 pt-3 border-t border-gray-200">
                        {% if can_validate_as_manager and telework.user.profile.manager == user %}
                            <form method="post" class="w-full">
                                {% csrf_token %}
                                <input type="hidden" name="telework_id" value="{{ telework.id }}">
                                <button name="action" value="approve" 
                                        class="w-full flex items-center justify-center gap-2 py-2 px-3 rounded-lg transition-all duration-200 font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 text-sm bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white focus:ring-orange-500">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                    🏠 VALIDER (Manager)
                                </button>
                            </form>
                        {% endif %}
                        
                        {% if telework.status == 'pending' %}
                            <form method="post" class="w-full">
                                {% csrf_token %}
                                <input type="hidden" name="telework_id" value="{{ telework.id }}">
                                <button name="action" value="reject" 
                                        class="w-full flex items-center justify-center gap-2 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white py-2 px-3 rounded-lg transition-all duration-200 font-semibold focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 text-sm"
                                        onclick="return confirm('Êtes-vous sûr de vouloir rejeter cette demande ?')">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                    ❌ REJETER
                                </button>
                            </form>
                        {% endif %}
                    </div>
                </div>
                {% empty %}
                <div class="text-center py-8">
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                        </svg>
                    </div>
                    <p class="text-gray-500 text-sm">Aucune demande de télétravail à valider</p>
                </div>
                {% endfor %}
            </div>
            
            <!-- Version desktop pour télétravail - Table simplifiée -->
            <div class="hidden lg:block">
                <div class="overflow-x-auto rounded-lg shadow-md">
                    <table class="min-w-full bg-white">
                        <thead class="bg-gradient-to-r from-orange-500/10 to-sky-400/10">
                            <tr>
                                <th scope="col" class="py-4 px-6 text-left font-bold text-orange-600">Utilisateur</th>
                                <th scope="col" class="py-4 px-6 text-left font-bold text-orange-600">Période</th>
                                <th scope="col" class="py-4 px-6 text-left font-bold text-orange-600">Statut</th>
                                <th scope="col" class="py-4 px-6 text-left font-bold text-orange-600">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            {% for telework in teleworks %}
                            <tr class="hover:bg-orange-50 transition-colors duration-200">
                                <td class="py-4 px-6 font-medium text-gray-900">
                                    {{ telework.user.get_full_name|default:telework.user.username }}
                                </td>
                                <td class="py-4 px-6 text-gray-700">
                                    {{ telework.start_date|date:'d/m/Y' }} au {{ telework.end_date|date:'d/m/Y' }}
                                </td>
                                <td class="py-4 px-6">
                                    <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium
                                        {% if telework.status == 'pending' %}bg-yellow-100 text-yellow-800{% elif telework.status == 'approved' %}bg-green-100 text-green-800{% elif telework.status == 'rejected' %}bg-red-100 text-red-800{% endif %}">
                                        {{ telework.get_status_display }}
                                    </span>
                                </td>
                                <td class="py-4 px-6">
                                    <div class="flex gap-2">
                                        {% if can_validate_as_manager and telework.user.profile.manager == user %}
                                            <form method="post" class="inline-block">
                                                {% csrf_token %}
                                                <input type="hidden" name="telework_id" value="{{ telework.id }}">
                                                <button name="action" value="approve" 
                                                        class="px-3 py-1 bg-orange-500 hover:bg-orange-600 text-white rounded-lg text-xs font-semibold transition-colors duration-200">
                                                    🏠 VALIDER
                                                </button>
                                            </form>
                                        {% endif %}
                                        
                                        {% if telework.status == 'pending' %}
                                            <form method="post" class="inline-block">
                                                {% csrf_token %}
                                                <input type="hidden" name="telework_id" value="{{ telework.id }}">
                                                <button name="action" value="reject" 
                                                        class="px-3 py-1 bg-red-500 hover:bg-red-600 text-white rounded-lg text-xs font-semibold transition-colors duration-200"
                                                        onclick="return confirm('Êtes-vous sûr de vouloir rejeter cette demande ?')">
                                                    ❌ REJETER
                                                </button>
                                            </form>
                                        {% endif %}
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="4" class="py-8 text-center text-gray-500">
                                    Aucune demande de télétravail à valider
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    {% endif %}
</div>
{% endblock %}
